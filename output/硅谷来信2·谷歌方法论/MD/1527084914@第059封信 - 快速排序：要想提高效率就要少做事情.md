# 第059封信 | 快速排序：要想提高效率就要少做事情

昨天我们介绍了好的算法和坏的算法区别有多大。那么你可能会问，世界上已知的最好的算法是什么呢？在评判“最好”之前，我们还是要加一些限制条件，比如是一般情况下最好，还是恶劣的情况下最好。为了便于你理解这两种情况的差别，我们不妨看这样一个例子。

我每次到北京，大部分时间住在东三环，因为那里到其它地方交通还算便利。从东三环到机场，通常情况下时间最短的线路是从三元桥到机场高速公路，大约40分钟。但是，如果东三环出现一点意外的交通状况，那就会堵得一点都动不了了，这条路恐怕就要花2个小时。如果要避免在这种倒霉情况下误了飞机，一个办法是走东四环然后上第二机场高速，后者比较偏僻，车比较少，即使遇到交通事故，也不会堵死。通常来讲，它比第一条线路慢15分钟，但是，在极端情况下，它比第一条线路快半小时。 **稍微有点生活经验的朋友都会知道，世界上，没有绝对的最好。**

类似的，计算机算法常常也是如此，最好的总是有附加条件，如果运行一个程序，实时性要求不是那么高，可能应该采用算法A；如果实时性要求非常严，比如下围棋进入了读秒阶段，就需要用算法B了，因为后者在遇到倒霉的情况时不会太糟糕。

讲回到排序这件事， **目前世界上通常情况下最好的算法是一种叫做"快速排序（Quicksort）"的算法，** 他是由英国计算机科学家托尼·霍尔（Tony Hoare）于1959年想到的，1961年发表的，这个算法也成了今天世界计算机产业中使用最多的排序算法，霍尔因此获得了爵士头衔，也成为第一个获得这种头衔的科学家。 **那么快速排序为什么快呢？原因很简单，它还是强调少做事情，** 其原理大致是这样的：

 **首先，对于一大堆无序的数字，从中随机挑选一个，比如是53，这个被随机选上的数字被称为枢值（枢纽的枢），** 接下来，将所有要排序的数字分成两部分，第一部分是大于等于枢值53的，第二部分是小于枢值53的。在第一步完成后，一大堆无序的数字就变得稍微有序一点了。

 **第二步，从上面得到的两堆数字，分别采用第一步的方法各自再找一个枢值。** 对于第一堆，由于所有的数字都比53大，至少也等于53，因此，第二次随机挑选的枢值肯定是一个大于53的数字，比如79；类似地，对于第二堆，由于所有的数字都小于53，因此第二次随机挑选的枢值肯定小于它，比如4。接下来，再把两堆数字各自分成大于等于相应枢值的数字序列，以及小于枢值的数字序列。这样做下来，原来的一大堆数就变成了四小堆，它们分别是小于4的数字，介于4到53之间的，介于53到79之间的，以及大于或等于79的。

再接下来，用同样的方法，四堆变八堆，八堆变十六堆，很快所有的数字就排好序了。

这种算法通常情况下复杂度也是N乘以log（N），和昨天介绍的归并排序相同。根据计算机科学的标准，它们同样好，不过在工程上，快速排序算法一般情况下比归并排序快两倍，因此在工程上还是有意义的。这也是为什么很多人用它的原因。至于为什么快速排序能够更快一些呢？这可以在计算机科学上证明，不过为了方便理解，我打一个比方你就明白了。

假如有一个学区，里面有20000名高中学生，如果让大家到一个超级大的学校上大课，再从中挑出学生中的尖子，效率一定高不了。这就相当于是昨天一开始讲的冒泡排序，每一个人都要和所有人去比。如果我们把2万人放到10所学校中，每所学校只有两千人，从各个学校先各自挑出学习尖子，再彼此进行比较，这就有效得多了。这就是昨天说的归并排序原理。

如果我们先划出几个分数线，根据个人成绩的高低把20000个学生分到十所学校去，第一所学校里的学生成绩最好，第十所最差，再找出学习尖子，那就容易了，工作量最小，这就是快速排序的原理，也是快速排序比昨天讲的归并排序快的原因。

 *其实，计算机算法和组织的管理，乃至社会的管理，在道理上有相通性，想要提高效率就是要少做事情。* 一个社会的管理，要想效率高，最简单的办法就是对每一个人作一些区分，而效率最低的办法就是刻意追求所有人一律平等，不作区分。可以想象，当一个学校的学生水平都比较接近，老师教起来就容易，因此按照成绩对学生作一个初步的划分是有道理的，特别是在资源不足的情况下。反之，如果一个学校的学生从100分的到0分的都有，那么老师教起来就困难了，如果想达到前面同样的效果，就必须多投入资源。

从对比快速排序和归并排序大约三倍的效率之差，我还得到一个启发，那就是为什么美国私营公司的效率会比政府高很多。美国的政府和社会要讲究民主和平等，但是美国的公司里从来不讲这一套，公司里的大事从来不会和每一个员工商量，行政的层级就如同快速排序事先划定的枢值，有了三六九等，公司才有效率可言。

因此，当一个年轻的员工新入职后，处于最低的层级时，不要指望公司的政策是照顾底层的员工，因为那样的组织没有效率，没有效率的组织在竞争中是要死掉的，当一个公司死掉后，任何理想都成为了泡影。 **所以，每个底层员工所思考的事情，是如何进入更高的层级，** 这也是我从来不强调什么底层思维的原因，毕竟大家将来是会不断上升的，必须具有高层思维。底层思维，或者心灵鸡汤，无异于是一种毒药。如果你还在庆幸自己进入了一个最底层员工的工资和总经理差不多的单位时，趁着年轻赶快离开，因为这样的公司是要死掉的。

我在今天一开始讲，快速排序是通常情况下最好的算法，但是，在极端的情况下，它的复杂度是N平方，和冒泡排序一样糟糕。而归并排序，即使在最坏的情况下，也能保证N乘以log（N）的复杂度，当然工程师们会想一些方法防止这种糟糕情况的发生。从这个例子可以看出，世界上没有绝对的好，常常有一得便有一失。

最后大家可能还会有一个问题，随着科技的进一步进步，有没有可能发明一种比快速排序更好的算法？从科学上讲，答案是否定的。因为从数学上可以证明N个任意随机数的排序，复杂度不可能比N乘以log（N）更低，这是数学给出的极限，或者边界，因此有点头脑的人都知道别在这方面瞎费工夫。这也是我一直强调要在边界内做事情的原因。

我在腾讯面试工程师时，曾经遇到过一个学习计算机科学的学生，总是不相信排序算法的速度是有极限的，我给他看数学上的证明，他因为数学基础有限看不明白，于是我在想，这个人和痴迷永动机的人没有什么区别，没有救了。花时间培训这样的人是瞎费工夫，最好的办法就是像芒格说的那样，将那种人排除在组织之外。

上面就是我从快速排序算法中悟出的生活里的思维方式，希望对你有所启发。

最后邀请你思考一下， **从快速排序对效率的提高，你有什么对生活和工作的感悟？**

![https://piccdn3.umiwi.com/img/201803/06/201803062008311652549231.png](https://piccdn3.umiwi.com/img/201803/06/201803062008311652549231.png)

## 划重点

其实，计算机算法和组织的管理，乃至社会的管理，在道理上有相通性，想要提高效率就是要少做事情。

## 本周思考

鉴于本周的计算机算法来信比较烧脑，所以本周回信会相对简单些。正式回信的主题是： *请你对比参照一下，本周的计算机算法中，有哪些对你实际的生活、工作有帮助？你也可以试着总结几条方法论。* 

本周回信被选中的读者，会获得99元学习鼓励金。（根据回信内容决定有几位读者入选。）

回信方式：

1、通过邮件，把你的回信发到我在得到的邮箱：wujun@luojilab.com，文稿直接贴在邮件正文里就好，不需要单独加一个附件；

2、直接在留言区回信，标注 *#我从计算机算法中学到#。*

期待你的来信！

![https://piccdn3.umiwi.com/img/201803/06/201803062009235269229626.jpg](https://piccdn3.umiwi.com/img/201803/06/201803062009235269229626.jpg)

---
