# 第079封信 | 计算机经典算法：锦标赛排序算法

利用二叉树这个数据结构，或者说工具，我们就能讲解一个经典的计算机算法，叫做锦标赛排序算法，然后用这个算法，解决高盛的那道面试题，即如何从25个选手中赛出前三名。

先说说锦标赛排序法，顾名思义，它是受到体育比赛的启发想出来的。

在单淘汰的锦标赛中，选手们两两比赛，胜者晋级，败者被淘汰。比如世界乒乓球锦标赛或者大满贯网球赛就是这么进行的。这样一来，就可以把比赛的赛程和结果对应成一个二叉树。下图就是去年美国公开赛的赛程安排，它和二叉树长得一模一样。在树中每一个选手是二叉树中的一个叶子结点，每一场比赛就相当于两个数字在比大小。数字大的选手获胜进入下一轮，也就是说比大小，大的那个选手，进入上一层，成为枝干上的根。

所以，进入到某一轮比赛的选手，其实都是某个子树干的根结点。最后的冠军自然就是整个二叉树的根结点。当然，这种赛制的合理性来自下面一个假设：如果张三赢了李四，李四赢了王五，那么张三一定能赢王五。

也就是说： *A>B, B>C, 那么必然有A>C。* 我们不妨称这种合理的假设为“输赢的传递性”。

![https://piccdn3.umiwi.com/img/201804/10/201804101542069390736777.jpg](https://piccdn3.umiwi.com/img/201804/10/201804101542069390736777.jpg)

只要上面这种胜负的传递性成立，通过这种比赛的结果得到的冠军，一定是最好的选手。但是，第二名是否如此，就难说了。因为冠军一路打下来，被他刷掉的选手可能水平都不差，只是运气不好，提前遇到他了，在决赛之前被淘汰了。

比如说在某次网球比赛中，德约科维奇（人称小德）半决赛赢了费德勒，决赛赢了纳达尔。小德的冠军，不会有什么异议，但你说到底是纳达尔该得亚军，还是费德勒更厉害，还真不好说。费德勒只能怪自己那次抽签运气不好。因此，如果真要较真，就需要把被冠军淘汰下来的人放到一个组里再相互比赛，才能知道谁是亚军。当然，如今体育比赛规则已经成型，大家遵守就好，不必那么麻烦赛出第二名。

但是，在工程中如果要对比两个数字的大小，总不能说哪个数字最后被最大的比下去，就是第二大的吧。因此，如果采用类似锦标赛的方法排出了一、二、三名来，第一大的数字可以完全按照锦标赛淘汰制的方式来。但是第二大的数字，就需要从所有与最大数字比较过被淘汰的数字中，再次比较选择才能确定。当第二大的数字确定后，就可以用这种方法找到第三大的数字了。这种算法，由于受到锦标赛的启发，因此被称为是 **“锦标赛排序法”** （也称为树形选择排序）。总结一下这种方法，它分为两步：

 **第一步，把所有的数字放到二叉树的叶子结点，然后按照锦标赛单淘汰的方式，两两比较选出最大的。**

 **第二步，对于第二大的，从所有被最大的数字淘汰的数字中选择。** 比如在某次比赛中，被小德淘汰的分别是纳达尔、费德勒、穆雷等人，那么这些人再进行单淘汰，选亚军。对于第三、第四大的数字，可以以此类推。

如果用这种方式将所有的数字排序，算法的复杂度，或者说量级是N乘以Log N，和快速排序差不多。那么为什么不直接使用快速排序，而要发明出这样一种不太容易理解的算法呢？因为在特定的场合下，它更快速。比如说，如果我们只需要选出第一名，这种算法的复杂度只有N，不是N乘以Log N。如果还需要选出第二名，则额外增加Log N次计算就可以了，对第三名也是如此。也就是说， **这种方法在从N个选手中选出K个选手的事情中特别快。**

有了上述算法，就可以讲解高盛和Google的面试题了，当然任何算法用于实际的问题，都需要变通一下。我们先讲讲高盛的问题，它是这样出的：

 *假定有二十五名短跑选手比赛竞争金银铜牌，赛场上有五条赛道，因此一次可以有五个人同时比赛。比赛并不计时，只看相应的名次。假如选手的发挥是稳定的，也就是说如果约翰比张三跑得快，张三比凯利跑得快，那么约翰一定比凯利跑得快。最少需要几组比赛才能决出前三名？*

这道题是一位面试高盛的朋友告诉我的，他没有答好，拿来考我，我一下就答上来了。他说你真聪明，我说不是聪明，因为我学过计算机的理论，知道这类问题怎么解决。你是学金融的，要在40分钟内想出解法，只能靠智力了。这就如同我的枪是狙击步枪，有瞄准镜，打中目标不难，你只有三八大盖，只能靠射击水平。

后来我再把这个问题拿去问一位在高盛的朋友，他马上就答上来了，他没有学过计算机，答上来完全靠智力，说明高盛招的人不是浪得虚名的，因此， **如果你是天才，恭喜你，你的智力会让你做事比别人容易，但如果你不是，就像我不是一样，也没有关系，多掌握几个工具就好了。**

这个问题，我又问了很多人，他们大部分需要八次才能找出前三名，他们具体的做法如下：

第一步，将25名选手分为五个组，每组五个人，为了便于说明，我们不妨把这25人根据所在的组进行编号，A1-A5在A组，B1-B5在B组……最后E1-E5在最后的E组。

然后让每个组分别比赛，排出各组的名次来。不失一般性（数学中的一种常见表达），我们假设他们的名次就是他们在小组中的编号，即A组的名次是A1、A2、A3、A4、A5，B组和其它组的名次也是类似（如下图）：

![https://piccdn3.umiwi.com/img/201804/10/201804101542361310079787.png](https://piccdn3.umiwi.com/img/201804/10/201804101542361310079787.png)

第二步，让各组的第一名，也就是A1、B1、C1、D1、E1再比一次，上图中是第一排红颜色的，这样就能决出第一名。不失一般性，我们假设A1在这次比赛中获胜，这样我们就知道了第一名。

由于A1是第一名，根据我们前面讲的淘汰赛的问题，A2可能也很厉害，只是运气不好，小组赛遇到了A1，当A1已经获得冠军了，他就应该作为亚军的候选。接下来，就进入第三步。

第三步，A2和另外四个组的第一名竞争亚军。如果这一次A2赢了，他显然是亚军，就由A3递进参加争夺第三名的比赛。我在下图中用红色圈定了这种情况下参加第八次比赛的五位选手。如果A2没有赢，另四个组的某个第一名赢了，那个赢的人是亚军，就由那个组下一位选手递进，决逐第三名。

![https://piccdn3.umiwi.com/img/201804/10/201804101542562912232638.png](https://piccdn3.umiwi.com/img/201804/10/201804101542562912232638.png)

第四步，如上图选出的五个人进行第三名的比赛，至此，前三名全部产生。

如果你在面试中告诉对方上面这种方法，表现可能算是中规中矩，但不算完美。

那么这个问题最好的答案是什么呢？其实前六次比赛都是必须的，也就是说，最佳答案的前两步和上述答案中的前两步是相同的。但是，在上述方案中，有一个信息被忽略了，那就是在第六组比赛（即五个第一名的比赛）结束之后，最后的两名已经没有资格决逐前三名了。我们不妨假设那一次比赛从最快到最慢的结果是A1、B1、C1、D1、E1。在D1和E1之前已经有三名选手了，他们肯定不是前三名。

那么谁还会是第二名的候选呢？根据锦标赛排序的原则，直接输给第一名的人，也就是A组中的A2，以及最后附加赛输给他的B1，仅此两人而已。接下来我们要问，除了A2和B1，谁还会是第三名的候选呢？和A1在某一组比赛的第三名，他们是A3、C1，或者输给第二名候选人B1的人那个人，即B2。

因此，第二、三名的候选人一共只有五个，即A2、A3、B1、B2和C1（下图中的红色选手），刚好凑一组。第七次，让他们五个人再跑一次即可。这样加上前六次，只需要赛七组，这是最佳的方法。

![https://piccdn3.umiwi.com/img/201804/10/201804101543198999475552.png](https://piccdn3.umiwi.com/img/201804/10/201804101543198999475552.png)

这种方法为什么比很多人想到的赛八次的方法更有效一点？原因可以归结为两点：

 **首先是少做了一些无用功。** 在八次的比法中间，最后两次让D1、E1不断参加没有必要的比赛，实际上是浪费资源。有些人写的计算机软件速度快，有些人的慢，主要差别在于那些慢的软件，多做了很多无用功。

 **其次，要善用信息。** 前几次比赛的结果里面有很多有用的信息，比如其实已经筛选出了前三名的候选，这些信息要善于使用。

这道题虽然是高盛出的，我觉得拿来考计算机专业的人更合适一些，可以考察他们所学的专业知识，而且可以考察他们应用计算机知识解决其他问题的应变能力。我问过一位高盛的主管总监（MD），为什么要出这道题？因为它和金融无关。那位朋友讲，高盛在招人时，总要照顾一些关系户，这虽然不公平，但是也没有办法。但是，剩下来的人就必须能一个人干两个人的活了，一个前提就是人必须聪明，这种题其实就是考智力。当然， **从这个问题的解法上你已经看出，善于掌握工具（锦标赛排序），可以弥补智力上的不足。**

明天，我们沿着今天的思路再往前走一步，用这种方法解决Google的一道面试题。

最后邀请你思考一下：从锦标赛排序，你获得了什么启发？

![https://piccdn3.umiwi.com/img/201804/10/201804101543531506294655.png](https://piccdn3.umiwi.com/img/201804/10/201804101543531506294655.png)

## 划重点

锦标赛排序算法的优点是：

1.少做无用功

2.善用信息

## 本周思考

本周计算机的数据结构可能稍难理解，需要时间和梳理来消化。本周的回信主题就稍简单一些，希望你可以总结一下 **本周计算机的数据结构的内容** ，并且梳理一下自己得到了哪些启发。本周日会精选读者的回信刊登在专栏中，希望你可以和大家分享你的学习心得。

本周回信被选中的读者，会获得50元学习鼓励金。（根据回信内容决定有几位读者入选。）

回信方式：

1、通过邮件，把你的回信发到我在得到的邮箱：wujun@luojilab.com，文稿直接贴在邮件正文里就好，不需要单独加一个附件，邮件标题 *#计算机的数据结构总结#；*

2、直接在留言区回信，标注 *#计算机的数据结构总结#。*

期待你的来信！

![https://piccdn3.umiwi.com/img/201804/10/201804101544481424152485.jpg](https://piccdn3.umiwi.com/img/201804/10/201804101544481424152485.jpg)

---
