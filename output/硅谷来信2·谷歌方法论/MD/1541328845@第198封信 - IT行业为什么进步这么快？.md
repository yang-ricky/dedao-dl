# 第198封信 | IT行业为什么进步这么快？

这一周（11月5日－10日）的内容谨以纪念IBM的系统360大型机之父吉尼∙阿姆达尔（Gene Amdahl）博士，因为他在三年前的这一周去世了。

阿姆达尔一生至少有四个标签，最伟大的计算架构师之一（一般认为能和他相比的只有巨型机之父西摩·克雷Seymour Cray），阿姆达尔法则（Amdahl Law）的提出者，微软FUD策略（代表恐惧、不确定和怀疑）的发明人，以及“地狱的常客”。

今天我们先讲讲 *阿姆达尔法则，这是IT行业得以快速进步的战术* ，和它相对应的是摩尔定律，这是IT行业的战略。后者大家都听说过，但是对于前者大家常常比较陌生，虽然你在工作中可能已经不自觉地使用了类似的原则。明天再讲阿姆达尔一生的经验教训。

要说阿姆达尔法则，先说说这个人。作为计算机科学家，阿姆达尔两度进入IBM公司，并且在上个世纪60年代设计了具有代表性的大型计算机“系统360（System/360）”。这是历史上最成功的大型机，没有之一，它和随后的变种，今天仍然为蓝色巨人带来数十亿美元的收入。

今天大学里的计算机系统结构课程，很多内容依然来自于系统360的设计思想。可以讲，靠这款大型机系统，IBM得以奠定它作为蓝色巨人的基础，当时IBM的CEO小沃森将他誉为“系统360之父”。

阿姆达尔在设计计算机系统时，充分认识到了计算机各部分的性能必须平衡匹配，才能得到整体性能最佳的系统。他将这种思想用一个简单的公式描述出来：

![https://piccdn3.umiwi.com/img/201811/04/201811041855576184197635.png](https://piccdn3.umiwi.com/img/201811/04/201811041855576184197635.png)

这个公式，其实学习了小学数学也能理解。它被称为了“阿姆达尔法则”。

在公式左边的大写的S代表系统最后的性能提升（加速），右边分母中的小写的s，代表某一项指标的性能提升，比如你把计算机里面内存的速度提升了两倍，右边的小s就是两倍。p代表这项提升被用到的比例（或者说概率，因为在计算机中一个局部对计算时间的影响是估计出来的，因此阿姆达尔用概率p代表），比如说内存的读写访问，占了计算机程序运行的20%的时间。

好了，在这样的假定前提下，如果你把内存的速度翻一番，即s＝2，那么整个计算机性能的提升是多少呢？根据这个公式，可以算出是11%。这个结果看起来还是不错的，如果你有办法将内存的速度提升到原来的100倍，那么计算机整体速度只能提升约25%，这看上去就不大有效了。

在每一次设计新的一代计算机产品时，都会有各种各样的技术突破，可供选用，但是考虑到成本的因素，以及设计的复杂度，都需要有所取舍，那么该引入哪些新技术呢？阿姆达尔法则是计算机行业作决定的铁律。我们不妨看这样一个例子。

假如内存读写占用程序运行时间的20%，处理器运算占60%。今天有两个技术，一个可以将内存读写速度提高5倍，另一个可以将处理器的速度提升50%，由于成本的限制和研发时间的限制，下一个版本只能采用一项改进。你应该选用哪个？

很多人会想，20%的5倍，好像效果显著；而60%的50%，也就30%，所以当然应该采用新的内存技术。阿姆达尔法则给出的结论，则恰恰相反。根据上述公式，提高内存的性能，计算机整体的性能只能提高20%（1/［（1－0.2）＋0.2/6]≈120%），如果提高处理器的性能，系统整体的性能能够提高25%（1/［（1－0.6）＋0.6/1.5]=125%）。有兴趣的同学可以自己验证一下。

接下来，如果一年后还要再推出一个新的系统，假定处理器和内存的性能提升的可能性和成本跟上一次相当，这回该改进计算机处理器，还是内存呢？

有人觉得还是该改进处理器，很遗憾，这一次该改进内存了。因为上一次处理器改进后，处理器运算占用的时间比例，也就是公式中的p，就从60%下降到50%了，再改进处理器，油水就没有那么大了。事实上，如果继续改进处理器，可以得到20％左右的性能提升，而改进内存这回能获得25%的性能提升。

不仅在计算机设计中阿姆达尔法则是铁律，在软件开发，调试软件性能时，负责任的工程师都要用这个铁律将能够提升明显性能的模块都优化一遍。在大型的计算机软件开发中，有一个叫做Profile的工具，可以模拟出软件中每一个功能模块占用资源的情况，这样把最占用资源的模块进行优化，很容易成倍提高性能。

阿姆达尔法则不仅是产品设计中选择技术的准则，更是整个计算机行业里决定研发投入依据的原则，也就是说，当前如果计算机系统中的哪个部分成为了拖后腿的瓶颈，就必须集中精力和经费解决相应的问题，这也就解释了为什么IT的关键技术似乎都在合适的时间获得突破的原因。

比如说到了2000年之后，计算机CPU的发展相对放缓，因为它太快了之后内存和硬盘跟不上。而在2005年之后，基于新的半导体存储技术NAND的闪存发展很快，容量大幅上升，成本大幅下降，这是因为当时的磁质硬盘成为了计算机大型服务器中的瓶颈，占掉了太多的运行时间，而采用基于NAND的固态硬盘可以在很大程度上解决这个问题。

我在约翰∙霍普金斯担任计算机原理以及计算机系统结构这两门课的助教时，教授每年考试都要围绕阿姆达尔法则出题。我说，这样学生们不都能猜到这道题么？他对我讲，凡是从事计算机工作的， *要把这个法则永远放在脑子最容易想到的地方* ，并且以此为行动准则，这是计算机行业进步快的原因。

和阿姆达尔法则相反的做法，是净捡容易改进的地方改进，比如有些工程主管自己做了一辈子的存储，永远会强调存储的重要性，当然做处理器的主管也会强调他那一部分的重要性，最后没有原则的公司要么面面俱到，要么会做没有必要的投入，这样一来，用不了几年进步的速度就落后了。

我在之前第149封来信中，讲了攻城和守城的关系，事实上，当一项改进完成后，相应部分占用的资源比重就在下降，人必须从这个部门转移到其他部门去解决瓶颈问题。

阿姆达尔法则不仅在IT领域如此，在经济学上，特别是资源调配上也很有指导意义。比如世界各国都在为二氧化碳排放和全球变暖问题争吵，这件事为什么没有一个结果呢？因为提倡二氧化碳减排的国家在全世界二氧化碳排放的占比太小，它们即使将二氧化碳排放降到了零也没有用。

![https://piccdn3.umiwi.com/img/201811/04/201811041859044696903729.png](https://piccdn3.umiwi.com/img/201811/04/201811041859044696903729.png)

这张图是全球各国二氧化碳排放的占比。你可以看到欧洲（除俄罗斯）排放最多的五个国家（德、英、意、法、波），不过占了6%，它们即使降到了零，也没用。

中国和美国占到了43%。如果这两个国家能降低15%，贡献比欧洲降为零还大，而这两个国家恰恰不愿意降，另外印度、南非、巴西，以及灰色的其它国家（目前占到21%）还在增排。因此，欧洲和日本减的那一点还补不上发展中国家增加的。

对于个人而言，阿姆达尔法则也是我决定该做什么事情，不该做什么事情的原则。那些只能产生1%效果的事情，你就是把结果提高一百倍，影响力也有限；相反，那些占到了一半以上效果的事情，哪怕改进5%，至少我们能看到2.5%的整体提高。计算公式：

> 1/［（1－P）＋P/S]，如果p＝50%=0.5，S＝1.05, 代入后等于1.024，也就是可以提高2.4%，如果是一半以上的效果，就能有至少2.5%的提高，如果S＝101，P＝1%＝0.01，代入后等于1.009，得到的提升不到1%。

当然，当一些问题得到解决后，它们的重要性就下降了，这时我们就需要寻找新的重要问题去解决。整个IT行业就是这样自觉和不自觉地、滚动地进步的，而每个人也不妨用这个原则审视一下自己该做和暂时不该做的事情。

明天我们讲讲阿姆达尔这个人，并且将他和另一个发明家作一下对比。

 *思考题：*

阿姆达尔法则在你的行业或者生活中有哪些应用呢？

![https://piccdn3.umiwi.com/img/201811/04/201811041903077815145283.png](https://piccdn3.umiwi.com/img/201811/04/201811041903077815145283.png)

## 划重点

1.阿姆达尔法则，这是IT行业得以快速进步的战术。

2.凡是从事计算机工作的，要把这个法则（阿姆达尔法则）永远放在脑子最容易想到的地方，并且以此为行动准则，这是计算机行业进步快的原因。


![https://piccdn3.umiwi.com/img/201811/04/201811041903340862975628.jpg](https://piccdn3.umiwi.com/img/201811/04/201811041903340862975628.jpg)

---
