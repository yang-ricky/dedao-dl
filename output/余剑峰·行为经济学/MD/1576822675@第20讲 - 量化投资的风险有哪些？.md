# 第20讲 | 量化投资的风险有哪些？

你好，欢迎来到清华五道口《行为经济学》的课堂，我是余剑峰。

这一堂课我们主要来讲一讲量化投资的各种风险，为什么我们要讲量化投资的风险呢？因为除了索罗斯、巴菲特的这些策略，我们前面讲的大多数都是量化投资策略。

## 量化投资有哪些优势

什么叫做量化投资策略？大概思路就是，你把几千个股票的量价、基本面、财务报表，或者是网上你能搜到的任何数据全都拿过来，用电脑程序作分析，最后你买入前面10%的股票，可能是一两百个股票，同时卖空一两百个股票，达到分散风险的目的，这是量化投资策略的一个基本思路。

我们讲了这么多策略的好处，但必须提高警惕，就是它们有很大的风险，有哪些潜在的风险呢？我们这一节课会讲三个潜在的风险。讲量化投资策略这三个风险之前，我先稍微总结一下前面我们讲的那些量化投资策略的好处。

 **首先，量化投资策略一般涵盖面比较广，基本可以覆盖所有有数据的公司，这跟主观选股是不一样的。** 主观选股你要去公司调研，但你不可能调研几千个公司，你的时间、精力是有限的。

 **第二，量化投资策略非常及时，** 比如说你用电脑程序在网上爬虫，爬各种信息，如果你的电脑程序很快，立马就可以分析出来一些结果、信号，可能就是几毫秒的时间。这个时候你的大脑都没有反应过来，但是你的新的策略已经出来了，所以说它更加及时。

 **第三，量化投资策略可以减少人员方面的损失。** 比如说一个人编了很多程序，有很多策略都在电脑里面，这个人走了，那些策略还在。它不像主观选股，主观选股人员跟公司的各种关系，对行业的理解，是非常软的信息，不可以被描述出来，所以人员损失问题很大。

 **第四，量化投资策略还可以克服很多人性的偏差。** 比如说我们有损失厌恶，我们的交易会有处置效应，但是如果你用量化投资策略去做的话，你根本就不会感觉到这些东西，因为电脑直接就执行了那些买卖。这也是巴菲特说的，你投资成功的一个重要因素是要比较淡漠，不要有情绪，电脑去做交易就没有这么多情绪化的东西。

 **最后一点，量化投资可以做各种回撤，** 因为你有各种数据，所以说你可以看看历史上在各种情况下它的投资收益率大概是什么样的。虽然做回撤有时候也会有过度拟合的问题，但是它至少可以做比较科学的回撤、风控，把各种因子上的暴露都给控制掉。

## 什么是失效风险

好，讲完了量化投资的各种优势，下面我讲它面临的三个主要的投资风险，当然它还有其他的风险，这里我讲三个我认为最重要的。

我们先讲 **第一个，量化投资策略有时候会失效，但关键是我们不知道它什么时候会失效，而且它有时候失效，导致的损失会非常大，** 我给你举一个具体的例子。

前面讲过由于大家会有处置效应导致动量投资策略，就是说过去6个月收益率高的股票相对过去6个月收益率低的股票，未来6个月收益率也会很高。

动量投资策略在量化投资的地位其实是很高的，因为很多公司都会用。比如说当时非常有名的高盛的Global Alpha、还有AQR，这些公司都会多少用一点动量投资策略。动量投资策略有时候会失灵，而且失灵特别严重，它有时候会让你一个月输掉40%，接下来另外一个月还会继续让你输掉40%，这样的话如果你用动量投资策略，可能一两个月就爆仓了。

刚刚我说的这种亏损不是瞎编出来的，下面看一篇学术论文，是Daniel和Moskowitz最新的一篇JFE上的论文，我们看看动量投资策略到底是怎么亏钱的，哪几个月亏钱最多。

![https://piccdn3.umiwi.com/img/201912/22/201912221628323065554910.jpg](https://piccdn3.umiwi.com/img/201912/22/201912221628323065554910.jpg)

比如说它在1932年8月份一个月就亏掉78.96%，上一年7月份亏了60%。你可能会说，这都是很早以前大萧条时候的事情。那我再给你看最近的一些数据，比如说在2009年3月份一下就亏了39.62%，2009年8月份又亏了24.84%，2009年4月份也亏了45.99%。

所以如果你在2009年用了这个策略，那基本上公司就会倒闭了。所以你已经明确看到，这个非常流行的量化交易策略，风险是极大的，有时候会失灵。

我们看看它亏钱的这些月份有什么特征？我们观察发现，亏钱最多的这一个月的前两年，比如说2009年4月份亏钱了，那么2007年4月份到2009年3月份，整个市场的收益率是非常低的，这是一个特征。

同时2009年4月份这一个月市场在反弹，看见没有？如果你在2009年用动量投资策略，你买的是哪些股票？卖的是哪些股票？动量投资策略买的是那些过去收益率最高的股票，卖空的是过去收益率最低的股票。

2009年用动量投资策略，那就是卖2008年收益率最低的股票。2008年哪些股票收益率最低？那些银行股。2009年那些银行股反弹了，然后你卖空了这些银行股，你就会产生巨大的损失。

所以，虽然我们发现了动量投资策略有很大的风险，但是当我们发现这个风险是可以预测的时候，这是一个极好的事情，我们可以改进我们的投资策略。

我们可以做一个策略择时，就是说 *你不要直接就用动量投资策略，你应该控制一下，当前面整个市场收益率比较低的时候，你应该降低仓位，当前面整个市场的波动率很高的时候，你也应该降低你的仓位。*

这样你可以把动量投资策略的夏普比率从每年0.59提高到1.19，基本上是翻倍的，这是一个很大的提高。如果你用了刚刚那个改进，你可以避免大多数动量投资策略的大额亏损。

也就是说，很多时候本来是一个坏的东西，你只要理解其中背后的经济学根源，你反而可以把它变得更好。

## 什么是流通性风险

好，我们刚刚讲了第一个大的风险，你的策略有时候会失效，而且导致巨额损失。下面我们讲 **第二个大的风险，叫做流通性风险。** 这里面我们讲的流通性风险其实主要是指市场融资风险，不是指传统意义上的流通性风险。

你想我们前面讲了这么多心理偏差，讲了各种投资策略，其实很多人，尤其是那些量化投资基金经理，他们都知道这些投资策略。那就说明一个问题，很多量化投资基金的策略会很像，就会导致有流通性风险的问题。

举个例子，好多基金都用类似的策略，买入过去赢钱的股票，卖空过去输钱的股票，买入价值股，卖空成长股。现在有一个大的对冲基金，它由于某种原因必须要清仓，它要卖掉过去赢钱的股票，卖掉价值股，因为其他基金持有过去赢钱的股票，持有价值股，那其他的基金就会输钱。如果你的杠杆比较高，可能就要被迫平仓了，这就是融资风险了。

不光是杠杆高，有时候因为你亏钱了很多人会撤资，这是第二个原因，而且有时候你的保证金也会增加，因为你的仓位老是在那波动，所以会增加你的保证金。

总之各种原因都会导致你被平仓，那你会继续卖掉哪些股票？卖掉那些过去赢钱的股票和价值型股票，同时要买入成长型股票和过去输钱的股票，因为你要平仓。这样会导致那些价值型股票和过去6个月收益率高的股票，价格会进一步下降，其他的那些杠杆稍微低一点的公司也会被迫清仓，最后导致连锁的融资风险，你会输很多钱。

刚刚讲的是一个理论，其实是从一篇学术论文里面摘出来的，它是Lasse Pedersen和他的合作者Markus Brunnermier在2005年写的，2009年才发表。那个学术论文里面就讲了刚刚这个框架。

2007年有个大的投行Bear Stearns，它当时在次级债券上亏了很多钱，导致它的对冲基金必须清仓。它的对冲基金管了好几百亿美金。Bear Stearns的这个交易策略，也是量化交易策略，跟我们讲的很多策略是比较像的。

比如说它也是动量投资策略，也是价值投资，它买入过去6个月收益率比较高的股票和价值型的股票，那就要清仓，把这些股票卖了。最后导致这些股票继续在跌，但同时它又必须买入过去6个月收益率低的股票和成长型股票，所以过去6个月收益率低的股票和成长型股票的价格在往上涨。

但是其他对冲基金也是用这种类似的策略，由于Bear Stearns的清仓导致其他对冲基金亏钱了，然后导致一个什么现象呢？在2007年8月份第一个星期，如果你用了动量投资和价值投资策略，你的整个投资策略的收益率会跌25%左右，而且当时华尔街所有量化对冲基金确实都在不停地亏钱。

但如果你买的是指数基金的话，你可能没有任何感觉，因为整个指数没有怎么动，而且还涨了一点点。为什么会这样呢？因为价值型股票往下跌，但是成长型股票往上涨了，所以平均起来指数并没有什么反应。所以说如果你是指数投资者，你根本就没感觉到任何涨跌。

那我们现在回到刚刚讲的那篇论文的作者之一Lasse Pedersen， 2007年7月份他就被AQR邀请去做量化策略的全职雇员。AQR是当时最顶级的量化投资策略基金，现在也是最顶级的。他2007年7月份刚去，一个月就定下来了，8月份第一个星期他就发现公司每十分钟会输100多万美金，是非常稳定地在输。

他发现这跟他的论文的理论一模一样。当有流通性风险的时候，你的所有资产的相关系数都会增加，就会不停地输钱，所以说这跟有效市场假设完全是反的。在有效市场假说里，基本上来讲股票价格是比较随机波动的，随机波动就不会稳定地输钱。当看到稳定输钱的时候，他立马反应到这肯定是流通性的问题。

所以我觉得是由于Lasse Pedersen在AQR的存在，使AQR比其他公司更早一点意识到这是流通性的问题。那应该怎么应对？这其实不简单，大概的应对方法我觉得是这样的。

* 如果你的杠杆比较高的话，你知道是流通性问题，你应该提前清仓，因为到时候你也会被迫清仓，这样的话成本更高。

* 但是如果你没有什么杠杆，你可以等一等观望一下，因为流通性问题不会长久，最后价格都会回来的。

但是如果你有点杠杆怎么办？这个东西就不好说了，因为你也不知道它的价格确切什么时候回来，所以说起来容易但做起来很难。AQR开始确实亏了挺多钱，但当股票又反转的时候，它加了一些仓位，最后还挣了一点钱。

但是其他一些公司可能就没有这么幸运，包括当时最顶级的高盛的Global Alpha，它在那一个星期亏了22.5%，这也说明了Global Alpha对价值和动量投资的暴露是极大的。这也没什么稀奇的，因为Global Alpha的创始人是Cliff Asness，他也是AQR的创始人。他的毕业论文其实就是关于动量和价值投资的。

2007年8月份这一个星期的22.5%的亏损，直接导致Global Alpha这么牛的明星基金在2011年直接被关掉了。尽管这个基金在2008、2009年没有怎么输钱，尤其是2009年它避开了动量投资策略的巨额亏损。因为Global Alpha里面有很多做学术的人，估计这些人也知道2001年那篇学术论文，所以让他们在2009年避免了使用动量投资策略。但是尽管如此，由于前面短期亏了太多钱，导致大家失去信心，这个基金最后还是被关掉了。

从上面这个例子里面我们也看到了，一定要有策略上的创新，如果你的策略跟别人很像，你特别容易被别人输钱而传染到。所以说这也间接地看出了策略的创新很重要，这也是为什么我们要学习行为经济学，因为行为经济学可以告诉你很多策略的根源，有根源之后你才能改进，改进之后你才能跟别人的策略不一样。

前面我们讲了两个重要风险：一个就是策略有时候会失效，不但会失效，而且会导致你每个月亏得特别多；第二个风险我们讲了融资风险，有时候也叫流通性风险，是指由于你的策略跟别人很像，会导致你被迫清仓，给你带来很大的损失。

## 什么是模型风险

下面我们要讲量化投资中 **最后一个我认为非常重要的风险，就是模型风险，模型有各种参数，但这些参数又很难估计。**

虽然我们会做各种回撤，但做回测的话有时候也会过度拟合，做回测你也需要很多参数，这些参数怎么估计呢？有时候是特别难的。当你估计不准的时候可能会带来巨大的损失。我就讲两个具体的例子，由于模型里面的参数弄错了，导致各种估计错误，造成巨大的风险。

前面我们讲过LTCM（长期资本管理公司）在皇家荷兰和壳牌这个孪生股票上亏了很多钱的例子。当时LTCM持有很多仓位，风险非常分散。它的模型告诉他们，由于风险非常分散，估计每天最多也就会亏损3500万美金。

但是在1998年8月21号，它一天就亏了5.53亿美金，是3500万美金的好多倍。为什么会这样呢？因为模型里面有些假设，就是这些资产的相关性，这是特别难估计的。

正常来讲，历史上资产的相关性都比较小，但是一旦危机来了，导致很多资产的相关性都变得很高了。比如说当时亚洲金融危机，引起了俄国的各种危机。尽管LTCM买各种资产去分散风险，但是由于一下大家都开始跌了，这样导致它一天就亏损得特别多。

那为什么LTCM会被迫清仓呢？

一个重要原因是因为专业的基金基本上都要加杠杆，加杠杆当然就容易被迫清仓。但是这里面更重要的因素就是，当你低估了它们的相关性，你就低估了一天亏钱的数量，这样你会觉得自己输很多钱的概率是很低的，你就会把杠杆加得很高，但是你的估计又错了，就会被迫清仓。

就像长期资本管理公司一天亏了5.53亿美金，最后导致它很多其他地方被迫清仓，就像孪生股票那个交易，本来是可以挣钱的，最后却被迫清仓，导致它输钱了。

这个相关系数是极其重要的，我再给你讲一个例子，也是由于对相关系数低估的原因，导致很多大银行都产生巨额的亏损。

你想象一下，金融危机的时候，很多银行都买了很多打包的债券。打包债券的目的是获得标普给它们评级，很多评级都很高，一个重要原因就是因为它们觉得底下那些资产的相关性是比较低的。

那些房屋抵押贷款违约的概率是不太相关的。它们是这么假设的，因为历史上不太相关。其实，这个相关系数是极其影响打包之后这些产品的风险系数。

给你举一个具体的例子，这个例子比较简化了，但是你能看到这个相关系数到底有多重要。

我们先假定有5个房屋抵押贷款，5个放在一起然后打包，打包之后我们分成5层，ABCDE。最顶上那层A是最安全的，就是说除非5个全都违约，要不然最顶上那层不会输钱，因为只要还钱，就先还给它。

最下面那层是最不安全的，只要有一个房屋抵押贷款违约，它就会输钱。最顶上那层最安全，当然利率就低了，最下面那层最不安全，利率就会高一点，这都是常识。

下面看看如果你把风险系数给估计错了会产生什么样的结果。我们假设每个房屋抵押贷款将来一年违约的概率是5%。在第一种情况下，违约的相关系数是0，就是说ABCDE违约是独立的。

你想在这种情况下，它们同时违约的概率是多少？也就是说最上面那一层A会输钱的概率有多少？它要输钱一定要5个房屋抵押贷款同时违约，同时违约的概率是0.05的5次方，这是非常小的一个数字。

但是在另外一种极端的情况下，因为经济很萧条，它们都高度相关，很多时候违约概率就算没有1，但是也是很高的。如果在这种极端的情况下，违约的相关系数是1的话，你想想那个最安全的顶层，它输钱的概率是多少？因为只要有一个违约，其他都会违约，那它就输钱了，所以说就是5%。

当底层的五个房屋抵押贷款违约事件是独立的情况下，顶层A的资产，输钱的概率只有0.05的5次方。但是当五个底层的房屋抵押贷款违约的概率是完全相关的情况下，上面这一层输钱的概率是5%，相差多少倍呢？相差16万倍，就是说在这种极端的情况下，风险系数被低估了16万倍。

刚刚的16万倍当然是最顶层那个池子，如果是第二层B的话，风险系数被低估了1684倍，也是非常大的一个数字。所以，有些参数特别难估计，历史上它们很少同时违约，这是模型所面临的一个风险。

就像在经济危机的时候把风险估计错了，很多本来应该是比较危险的债券结果被评定为AAA，导致很多银行像花旗银行、UBS都持有它们，最后亏了很多钱。

为什么说这些相关系数或者一些其他参数估计不准，在量化策略中的风险尤其大呢？主要原因是因为量化策略基本上都是买卖很多股票、资产，你把这些东西放在一起打个包，你觉得风险非常分散，但是由于你对一些参数估计得不准，就像刚刚讲的长期资本管理公司的那个例子，你觉得风险分散了很多，但是其实没有那么多，然后你加了很大的杠杆，最后导致你亏了很多钱。

## 总结

好，我总结一下这节课讲的主要内容。首先，我们前面讲的大多数策略都是由于人的心理偏差引起的策略，都是基于量化的投资策略。我们这节课讲了量化投资策略面临的三个主要风险：

* 第一，这个策略可能会失效。失效的原因是因为策略本来就不可能一直有效，但是有时候失效会给你造成巨大的损失。失效的另外一些原因是过度拟合了。

* 第二，量化投资面临的第二个风险就是融资风险，有时也叫流通性风险，一个重要原因是因为很多时候量化投资策略比较相像，因为大家用的数据都差不多。如果有一个公司亏钱了，必须清仓，它就会传染到你，会导致你亏很多钱。这里面讲了2007年8月份Bear Stearns的量化策略危机。

* 第三，就是模型中的风险，因为你做量化投资策略有各种模型，模型里面有各种假设，各种输入的元素，那些输入元素的很多参数是很难估计的。当你估计不准的时候，有时候你自认为你的风险都分散了，但是没有你想象中的那么分散，你加的杠杆又过高了，这样容易被迫清仓，导致你输很多钱。

好，下一讲是最后一讲，我会给你提一些简单的投资建议和注意事项。

 *作业：关于量化交易，你知道还有哪些坑，大家应该小心避免，请你分享给大家。*

我是余剑峰，咱们下节课再见。

## 划重点

1. 量化交易的5个优势：涵盖面广，非常及时，减少因人员的损失，克服人性偏差，可以做回撤。
2. 量化交易的三大主要风险：有时会失效，并且带来巨大损失；会产生流通性风险；以及模型风险。

![https://piccdn3.umiwi.com/img/201912/22/201912221636041923523527.jpg](https://piccdn3.umiwi.com/img/201912/22/201912221636041923523527.jpg)

---
