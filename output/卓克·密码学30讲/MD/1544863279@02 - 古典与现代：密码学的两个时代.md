# 02｜古典与现代：密码学的两个时代

你好，欢迎来到我的密码学课，我是卓克。

第一节课里我们说到了俚语加密，其实它并不算完整的加密与解密，因为纳瓦霍语始终没被破译，所以缺少解密环节。

但从这节课开始，加密和解密就会成对儿出现了。在几千年历史中，它们一直此消彼长的对抗。

这其中有没有总体脉络呢？有的。这个剧情大致有7个世代，下面咱们一一梳理一遍。

## 1

最原始的第一代加密法说起来很简单，我们每个人都用过，就是 **“隐藏法”** ，也就是把信息藏起来。

从有文字出现，一直到现在都在用。破解方法就是认真搜找，纯粹是体力活。

史上第一个加密法的记载，是古希腊历史学家希罗多德记录的一个加密术的故事。这段故事，发生在他出生前300多年。

当时，强大的波斯帝国计划入侵希腊。斯巴达曾经的老国王得知后，偷偷把这个消息写在木板上又涂了一层蜡。这片木板成功躲过沿路卫兵的检查，到达斯巴达。收信人刮去表面的那层蜡，就发现了下面的密报。得知波斯人的入侵计划后，希腊开始备战。公元前480年，波斯舰队以为对方毫无准备，结果自己一天之内200多艘战舰被击沉，五年多的准备毁于一旦。

可以说，这次密报挽救了雅典和斯巴达，其实也等于挽救了现代文明。

因为现代文明有两个思想根源，一个是公元前5世纪巅峰时期的古希腊思想，一个是后来的基督教思想。

这场战争发生的前后，正是古希腊思想达到巅峰之时。如果当年雅典和斯巴达输掉的话，科学和民主可能都不会出现。

类似的“隐藏法”，在希罗多德的记录中还有更高级的。

比如先把送信人的头发剃光，然后把保密消息写在那人的头皮上，等他头发长出来后，让送信人出发，到了目的地再把头发剃光，保密消息就读出来了。

这个方法不但可以躲过沿路的盘查，甚至连送信人也不知道消息内容，只是送一次消息至少要2个月时间，有点长。

隐藏法还有很多种，比如把消息写在绸缎上，用蜡裹成一个小球，让送信人吞下去，到了目的地再想法取出。还有在熟鸡蛋壳上用一种药水儿（明矾和醋）写密文，之后蛋壳上不会有痕迹，只能剥了皮才能看到蛋白上有字。

这些隐藏法对付完全小白的人还可以，对付稍加提防的卫兵就不灵了。让他们留意一下蜡板，留意头皮颜色，见到熟鸡蛋就剥皮检查，这些信息就全都暴露了。

讲到这里，第一代加密法和破解法就全都讲完了。

简单来说，就是想方设法藏匿，解密方法就是想方设法翻找，有时候就是个体力活。但自从有了文字后人们就一直在用，直到今天人们藏私房钱时用的还是这个套路。

## 2

有很多家长爱翻孩子的日记，但假如孩子听过下面的第二代加密法，对文字进行简单加密，就完全可以把日记本摆在桌上，任凭家长怎么看也不知道写了什么。

这就是第二代的加密法， **移位法和替代法** 。

它们是大约5000年前出现的，直到9世纪才被阿拉伯人发明的频率分析法破解，中间隔了足足有4000年。在另一边的欧洲，实际上直到16世纪，都还没掌握这种破解方法。从这里我们也能感受到，阿拉伯文明曾经的辉煌。

移位法很简单。我举个例子，比如我的车牌号是1874，把每个数字都在数列中往后加1，那么1变2，2变3，1874就变成了2985。

因为都是数字你可能觉得反差不大，但如果字母也这样变化，看起来就很不一样了。字母顺序改变也是一样，从a排列到z，比如我要对hello world加密，加密规则呢，是每个字母都向后移动2位， “hello world”就变成了“jgnnq yqtnf”。

作为小白一看，这都什么啊，看不懂，其实它只不过做了基础加密而已。这就是移位法。

 **替代法也很好理解，就是把文中一部分字母用其他字母代替。**

比如 For man is man and master of his fate（人就是人，是自己命运的主人）。那如果，把其中的a都用z代替，o用y代替，e用w代替，i用x代替。就成了一段谁也看不出来的文字：

> For man is man and master of his fate.
> 
> Fyr mzn xs mzn znd mzstwr yf hxs fztw.

大约在距今5000多年前，古埃及人就在文字中使用了移位和替代法。别看基础，但很管用。这个方法广泛运用了接近4000年时间。

在漫长的时间里也出现了很多变种，比如顺序倒着写，或者奇数位和偶数位的变化不一样，或者把奇数和偶数位的字母拆分后，首尾相连等等。

这两种加密法的加密原理就是这样，你一听就懂，但是，想解密可就不容易了。

一条消息的长度如果有十几个词，想用试错的办法猜出来，只能采用排列组合。假设任何一个字母都有可能是26个字母中的任何一个，那这条消息每增加一个字母，排列方式就增加26倍。一句话可能的排列总数，也许要超过整个宇宙原子的总数，靠碰运气是没法猜出来的。

 **所以直到16世纪，欧洲人都没有破解法。**

## 3

你发现没有，只是两代加密法，一下就讲了5000年密码学发展史的前4500年。

为什么会跨度如此之大？其实就在于前4500年的加密法太简单了。那为什么简单的加密法还被使用这么多年？原因很简单，它们跟数学的关系非常微弱。

无论是加密还是解密，一旦用上了数学，就有意思多了。因为破解移位法和替代法的，就是我们每个人都知道的“概率”这个概念。具体的破解方法，我们下一讲详细讲。

我这里想说的是：不只是密码学，可以说， **一切科学**  **的**  **深奥程度，都可以大致用它背后的数学工具的复杂度衡量。**

就拿 **第三代的维吉尼亚密码** 来说，它是16世纪出现的，成功压制解密法长达300年，直到1900年左右被破解。

但也就是从这一代开始，加密和解密的迭代速度越来越快。原因你肯定也猜到了，因为现代科学出现了，复杂的数学工具开始在几乎所有领域应用。

而且也是从这一代加密法开始， **“钥匙”** 的概念诞生了。这可以说是整个密码学最重要的一个概念，我们后面每一讲，几乎都是围绕它展开的。

比如第四代加密法，是一战后发明的一种机器，叫 **恩尼格玛机** （Enigma）。它成功压制解密法只有25年左右，后来被数学家图灵破解，而钥匙就是最重要的突破口。

 **从第一代的隐藏法到图灵破解第四代的恩尼格玛密码机，实际上密码学的古典时代就已经进入了尾声。**

从纸笔时代到机械电子时代，最显著的差异就是加密的复杂度以及效率的大幅提高。

## 4

但从第五代加密法，也就是70年代出现的 **魔王加密系统** （Lucifer）开始，密码学就出现了分水岭。

因为计算机的出现，让加密解密的最小单位从字母变成了数字，数字的变化打乱了信息的底层结构。二进制的0和1，让密码的复杂度一下就上升了不知道多少个数量级。

 **所以，在计算机出现之前的密码学叫做古典密码学，之后的叫做现代密码学。**

第五代加密法虽然很难破解，但递送钥匙的过程有明显漏洞，还有待提升。这个咱们会在后面详细讲到。

70年代末，第六代的 **RSA加密系统** 出现了，它解决了钥匙递送中的漏洞，可靠性大幅提升。虽然它并不是无法破解，但因为计算量太大，在理论上破解时间无限长。

 **目前互联网加密的底层，就是RSA加密法。** 我们生活的这个加密一方赢面较大，解密一方处于劣势的时代，正是建立在第六代加密法的基础上。

但如果量子计算机出现，计算机算力大幅增加，无限长破解时间可能会缩短为几分钟到几小时。而在这之前，RSA加密法暂且可以算作没有破解方法。也是从第六代开始，你会越来越强烈的体会到“钥匙”这个东西的重要性。

第七代加密法是 **量子加密** ，它背后的理论支撑是测不准原理和特殊的算法。

当前因为技术水平不够，只能对长度比较短的钥匙加密，而不能对整个信息加密。据说在一些国家的高级保密单位已经开始使用。 **它从物理学和数学原理上是不可破解的，是最强的加密法。**

## 5

说完了这7代加密法的出现和破解，不知道你发现了一个规律没有：

 **每一个加密法出现，到它的破解法诞生，间隔时间在剧烈的缩短。** 比如最初，替代法和它的破解方法频率分析，相隔了四千年时间；而到了二战时候，恩尼格码机的出现到破译只用了十多年时间。

其实这也映射出科学技术提升的趋势。科技一直发展是尽人皆知的，而加速的程度在变得更剧烈，就很少人察觉了。

可能有的人要问，不对，RSA加密，不都出现了40年了吗，为什么没有破解？

这就要说到另一个贯穿整个密码学发展的规律：

我们能了解到的现代密码学进展，都是军方、保密机构允许我们知道的。今天一定有很多进展和破解法已经出现，但出于国家安全的需要，只能等它们彻底过时，官方才会公布资料，我们才能知道其中的细节。

下节课，我们开始从第二代加密法详细说起。

![https://piccdn3.umiwi.com/img/201812/17/201812170032526357863510.jpg](https://piccdn3.umiwi.com/img/201812/17/201812170032526357863510.jpg)

---
