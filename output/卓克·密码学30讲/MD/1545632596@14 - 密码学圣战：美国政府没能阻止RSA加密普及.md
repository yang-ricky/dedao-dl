# 14 | 密码学圣战：美国政府没能阻止RSA加密普

你好，欢迎来到我的密码学课，我是卓克。

## 1

上节课，我们讲了RSA加密法的加密原理，知道了这种非对称加密的高明之处，那就是不用相互交换钥匙，就能实现信息的传递。

现在问题来了： **在现实通信中，保证了通信内容不被窃听就足够了吗？**

当然不是。因为人们可以不伪造内容，只伪造发信人就行了。

那我们怎么确认发信人的身份呢？这节课我们介绍的 **数字签名** ，就能解决这个问题。

在普通文件中，签名的作用是让对方确信这封信来自于发信人。签名之所以可信，是因为笔迹是难以模仿的。而在互联网出现后，使用RSA加密法就会出现一个问题——可能没法确认这条消息是不是落款人发的。

咱们假设一个场景：

爱丽丝和伊芙同时在追求鲍勃，伊芙可以查一查鲍勃的公钥，然后冒充爱丽丝给鲍勃写信，说自己已经结婚，孩子都好几岁了。这样鲍勃就不会再选择爱丽丝，而会选择伊芙。

那鲍勃怎么才能确认这封信确实源自爱丽丝呢？那就需要签名才行。但问题是，数字信息没有笔迹的。怎么办呢？

没关系。 **只要把RSA公钥加密私钥解密的过程，反着操作一遍，就可以起到确认身份的功能。**

## 2

这里有点复杂，咱们慢慢说：

本来一条信息应该用公钥加密，私钥解密。但有这样一个事实：

 **在数学上可以保证，假如我们不那么操作，而是反向操作——用自己的私钥加密信息，而用那把公钥解密的话，也一样可以解开。**

不过因为爱丽丝的公钥完全是公开的，所以她能解开，其他人也都可以解开。这样加密就很脆弱，但是这个过程正好可以用来确认身份。

你想，如果一条加密过的信息能用爱丽丝的公钥解开，那就说明这条信息当初肯定是用爱丽丝的私钥加密的。世界上谁有爱丽丝的私钥呢？只有她自己。所以凡是这样的信息，就一定证明它来自于爱丽丝。签名的功能，就是这样实现的。

不过这种信息用公钥就可以解开，谁都可以看，太不安全了，还要改进一下。怎么改进呢？

就是用鲍勃的公钥再加密一次。 **因为信息是发给鲍勃的，为了只给鲍勃看，所以就用鲍勃的公钥再加一次密。**

所以，这条消息等于是加了两次密。第一次加密，是为了确保发信人是爱丽丝；第二次加密，是保证只有鲍勃能解开。

所以带着签名的RSA加密，就有点儿像一个鸡蛋有两层壳：第一层软壳在内层，是为了核对签名用的；第二层硬壳，是在外面保护信息用的。

 **当非对称钥匙+数字签名，两大功能齐备后，RSA加密就非常实用了。**

## 3

后来真的有人把这两个功能综合在一起，编成软件发布在了网上。而这个事件，引发了90年代整个世界对私人信息保护的大讨论。咱们下面详细说说这个事儿。

最早提供RSA加密的数字签名软件有2个，除了发明了RSA加密法的RSA公司自己外，还有一个软件叫“极佳隐私”，简称PGP（Pretty Good Privacy）。这个PGP是个叫菲尔·齐玛曼（Phil Zimmermann）的程序员自己搞出来的，还是个免费软件。

1980年代，如果一封邮件的内容完全采用RSA加密法，要CPU全力工作几分钟才能完成。这个速度太慢了。如果信息对话似的一条接一条发、一条接一条发，CPU根本来不及处理。

所以，发明PGP软件的齐玛曼就做了个小调整——

 **信息的主体部分，仍然采用传统的对称钥匙加密。** 估计你也想到了，对称钥匙在加密过程中，是需要双方传递钥匙的。 **在传递钥匙的时候，采用非对称钥匙给这个对称钥匙加密。** 也就是说，给钥匙文上再加一把钥匙。

因为钥匙文一般比信息原文短小很多，所以这个用计算机处理就轻松很多。而且这个软件把发送钥匙、切换加密法等所有步骤，都设计在后台自动执行，用户根本碰不到，用起来很方便。所以这个软件在互联网上一出现，就特别受欢迎。

但我一直没提的是， **齐玛曼做的这个PGP软件，既没有RSA的专利权，也没被RSA公司授权过。** 也就是说，这是一个侵权事件。

大多数侵权事件都是以赔钱告终，但这件事非同小可。在轮到讨论经济赔偿之前，联邦调查局就先找来了，理由是齐玛曼涉嫌违反《武器出口限制法案》。通俗的说，他把PGP放在互联网上，他就是一个非法军火贩子了。

这是怎么回事呢？

《武器出口限制法案》是美国在1976年颁布的，限制出口的东西不但包括导弹、榴弹炮、机关枪，也包括加密软件。它们都属于武器，在没有总统许可的前提下，都禁止出售到国外。

所以从1993年2月开始，针对齐玛曼的司法调查就开始了。但谁也没想到，这个侵权事件会引起全美国乃至全世界密码学家、政客、民权人士和执法部门的大争论，时间长达7年之久。

## 4

最开始，大家的争论点在于，一个程序员在网上的论坛公开了一个软件，这就能算出口武器了？

这还真得两说。如果他把软件拷到盘里寄出国，那就能算出口武器；如果他把含有软件的整台计算机寄出国，也能算出口武器。但齐玛曼没有把任何实体的东西运出国，他只是把软件放在了电脑上，恰好那台电脑接通了互联网。敌对国家有可能下载了，也可能没下载这个软件，这能算出口吗？

从齐玛曼这里流出的只是知识，如果传播RSA知识就算出口武器，那1978年那篇关于RSA加密的论文，也得算是出口武器了。

这是关于案件本身的争论， **更深入的争论，涉及到信息传输上的人权和公权力的界限上了。**

支持维护个人权力的那一方，观点很好理解——民众可以利用任何合法的技术，保护自己的通信安全，任何机构无权侵犯。

这个观念是西方社会的传统价值观，从中世纪开始就一直有。一间屋子，风能进雨能进，国王不经主人允许不能进。这体现了对个人财产的尊重和保护。个人数字信息也有个人财产的属性，所以未经允许不得窃听。

政府也有自己的理由，他们认为法院许可的监听，是执法人员对付毒品、恐怖主义、暴力犯罪、叛国和其他有组织犯罪，最有效果的调查技术。而且犯罪组织成员，往往就是最先进加密系统的积极使用者。政府举了几个非常有说服力的例子，比如哥伦比亚的卡里集团（Cali cartel），就是通过加密通讯贩卖毒品和武器的。

支持保护个人信息安全的人不服，他们又举了很多政府滥用监听的例子。

比如黑人民权运动领袖马丁·路德·金，他的电话就常年被监听，然后FBI把监听到的他私生活不检点的消息，散布给反对者。法国国家情报局也一样滥用，他们每年大约进行10万次非法监听。

除此之外，还有一个更有说服力的。1994年全年，美国25万件联邦诉讼案里，只有1000件是在办案过程中需要申请监听，占比整个案件的4‰。也就是说，加密技术不会造成多大执法障碍，因为绝大多数案件不是靠监听破获的。

在这场争论中，还出现了以这个为主要矛盾点的电影。《终极密码战》说的是一个9岁的患了自闭症的孩子，偶然解开了一种新密码。国家安全局认为他威胁到了国家安全，派人暗杀他，结果布鲁斯威利斯扮演的英雄拯救了孩子。

还有更著名的电影，叫《全民公敌》。也是因为一个政客支持民众加强密码系统，而遭国家安全局的暗杀。总之，国家安全局在电影里就不是什么好角色。

在密码学家一方，大都是支持加强密码的强度，反对国家监听的。后来就连RSA公司都在这个问题上站到了齐玛曼那边。好像齐玛曼侵权只是家庭内部矛盾，而政府借这个案件大幅限制密码学应用，才是真正的威胁。

除了支持和反对方，还有第三方意见。他们想了另外的对策，既可以保证RSA加密可以继续使用，又可以满足政府监听的需求。那就是建立一个私人钥匙的第三方托管平台，大家把私钥都交到第三方那里。

但这个折中方案只有政府支持，其他所有人都认为这是换汤不换药的监听滥用。

## 5

齐玛曼在3年多时间里接受调查、打官司，越来越多的民权人士和密码学家都支持他，世界各地都在为他的官司募款。

也因为讨论的太热烈，那个免费软件PGP的使用量也越来越大。甚至到后来，麻省理工学院出版社还专门为PGP出了一本600多页的书，这本书畅销全球。

到了这时候，如果联邦调查局继续起诉齐玛曼的话，按理说也得起诉麻省理工学院出版社。考虑到当时的民意，FBI如果坚持起诉大概率会在之后的庭审中落败。

那时候就不只是齐玛曼无罪这么简单的结果了，更可能诞生出让加密系统普及化的法律条文。所以最终在1996年3月，最高检察院撤销了对齐玛曼的控诉。

接下来，就是解决家庭内部矛盾了，也就是RSA专利侵权的部分。结果意想不到，RSA公司和齐玛曼达成协议，PGP软件免费获得了许可，专利权问题轻松解决。

后来齐玛曼就此成立了PGP公司，这个公司又过了几年，被著名的网络安全公司赛门铁克收购。齐玛曼此后一直在密码学技术和相关的法律领域工作，他后来还是无线USB标准中密码协议的主要设计者，也是斯坦福大学法学院网络与社会中心的研究员。

他在密码学界中，更是有个外号—— **密码学圣战战士** 。

## 6

最后，我要从技术发展的角度来说说：

我们和生活在1000年前的人不同。那个时代，技术是有天花板的。凡是由新技术造成的问题，可能需要其他部门解决。

 **而现在，我们生活在一个技术没有天花板的时代，由新技术造成的问题，只能由更新的技术解决。**

这是一个现代人应该有的观念。

这节课就到这里。

接下来我会用两节课的时间，专门给你讲讲在日常生活中怎么保障自己密码的安全。

![https://piccdn3.umiwi.com/img/201812/24/201812241427087654848625.jpg](https://piccdn3.umiwi.com/img/201812/24/201812241427087654848625.jpg)

---
